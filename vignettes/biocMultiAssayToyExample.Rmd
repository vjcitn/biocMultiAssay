---
title: "biocMultiAssayToyExample"
author: "Marcel Ramos, Levi Waldron"
date: "September 4, 2015"
output: html_document
---

In this example we have 4 patients, and a bit of metadata on them:
```{r}
masterpheno <- data.frame(sex=c("M", "F", "M", "F"),
                          age=38:41,
                          row.names=c("Jack", "Jill", "Bob", "Barbara"))
masterpheno
```

We have three matrix-like datasets.  First let's say expression data:

```{r, message=FALSE}
library(affy)
(arraydat <- matrix(seq(101, 108), ncol=4, dimnames=list(c("TP53", "EGFR"), c("array1", "array2", "array3", "array4"))))
arraypdat <- as(data.frame(slope53=rnorm(4), row.names=c("array1", "array2", "array3", "array4")), "AnnotatedDataFrame")
exprdat <- ExpressionSet(assayData=arraydat, phenoData=arraypdat)
exprdat
```

The following map matches masterpheno sample names to exprdata sample names.  Note that row orders aren't initially matched up.
```{r}
(exprmap <- data.frame(master=rownames(masterpheno)[c(1, 2, 4, 3)], assay=c("array1", "array2", "array3", "array4")))
```

Now methylation data.  It uses gene identifiers also, but measures a partially overlapping set of genes.  For fun, let's store this as a simple matrix. Also, it contains a replicate for one of the patients.

```{r}
(methyldat <- matrix(1:10, ncol=5, dimnames=list(c("TP53", "CXCL12"), c("methyl1", "methyl2", "methyl3", "methyl4", "methyl5"))))
```

The following map matches masterpheno sample names to methyldat sample names.

```{r}
(methylmap <- data.frame(master = c("Jack", "Jack", "Jill", "Barbara", "Bob"),
                        assay = c("methyl1", "methyl2", "methyl3", "methyl4", "methyl5")))
```

Now we have a microRNA platform, which has no common identifiers.  It is also missing data for Jill.  Just for fun, let's use the same sample naming convention as we did for arrays.

```{r}
(microdat <- matrix(201:212, ncol=3, dimnames=list(c("miR1", "miR2", "miR3", "miR4"), c("array1", "array2", "array3"))))
```

And the following map matches masterpheno sample names to microdat sample names.
```{r}
(micromap <- data.frame(master = c("Jack", "Barbara", "Bob"),
                        assay = c("micro1", "micro2", "micro3")))
```

Let's include a GRangesList:  

```{r}
library(GenomicRanges)
rangedat <- lapply(1:5, FUN = function(x){ 
data.frame( seqnames = rep("chr1", 5), 
	ranges = IRanges(floor(runif(5, 0, 100)), floor(runif(5, 80, 180))),
	strand = rep("+", 5), score = floor(runif(5, 1, 5)) ) })

rangelist <- GRangesList(lapply(rangedat,FUN = function(x) {
	GRanges(seqnames = x$seqnames, ranges = IRanges(x$ranges.start, x$ranges.end), strand = x$strand, score = x$score) } ))

names(rangelist) <- c("range1", "range3", "range4", "range2", "range2")
mcols(rangelist) <- data.frame(row.names = c("Jack", "Bob", "Barbara", "Jill1", "Jill2"), 
					tss = rep("lung", 5), ptid = c("1221", "1321", "1322", "1222", "1222"))
```
The following data.frame matches masterpheno sample to the GRangesList: 

```{r}
(rangemap <- data.frame(master = c("Jack", "Bob", "Barbara", "Jill", "Jill"), 
						ranged = c("range1", "range3", "range4", "range2", "range2")))
```

